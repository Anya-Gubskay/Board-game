<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Управление комнатами</title>
</head>
<body>
  <h2>Создать новую комнату</h2>
  <input type="password" id="createPassword" placeholder="Введите пароль">
  <button id="createRoomButton">Создать комнату</button>
  <p id="roomLink"></p>

  <h2>Удалить комнату</h2>
  <input type="text" id="roomIdInput" placeholder="Введите ID комнаты">
  <input type="password" id="deletePassword" placeholder="Введите пароль">
  <button id="deleteRoomButton">Удалить комнату</button>
  <p id="deleteRoomMessage"></p>

  <script>
    // Создание комнаты
    document.getElementById("createRoomButton").addEventListener("click", async () => {
      const password = document.getElementById("createPassword").value;
      if (!password) {
        alert("Введите пароль");
        return;
      }

      const response = await fetch("/create-room", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ password }), // Отправляем пароль
      });

      const data = await response.json();
      if (data.roomId) {
        const roomLink = `${window.location.origin}/?roomId=${data.roomId}`;
        document.getElementById("roomLink").innerHTML = `Комната создана: <a href="${roomLink}" target="_blank">${roomLink}</a>`;
      } else {
        alert("Ошибка: " + data.error);
      }
    });

    // Удаление комнаты
    document.getElementById("deleteRoomButton").addEventListener("click", async () => {
      const roomId = document.getElementById("roomIdInput").value;
      const password = document.getElementById("deletePassword").value;
      if (!roomId || !password) {
        alert("Введите ID комнаты и пароль");
        return;
      }

      const response = await fetch("/delete-room", {
        method: "DELETE",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ roomId, password }), // Отправляем пароль
      });

      const data = await response.json();
      if (data.success) {
        document.getElementById("deleteRoomMessage").innerText = data.message;
      } else {
        document.getElementById("deleteRoomMessage").innerText = "Ошибка: " + data.error;
      }
    });
  </script>
</body>
</html>
